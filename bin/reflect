#!/usr/bin/env php
<?php
// CLI version
//putenv("REFLECT=/path/to/reflect.json");

$baseDir   = dirname(__DIR__);
$vendorDir = $baseDir . '/vendor';

if (\Phar::running()) {
    require_once 'phar://phpreflect.phar/vendor/nikic/php-parser/lib/bootstrap.php';
    require_once 'phar://phpreflect.phar/vendor/symfony/class-loader/Symfony/Component/ClassLoader/UniversalClassLoader.php';
    require_once 'phar://phpreflect.phar/vendor/pear-pear.phpunit.de/PHP_Timer/PHP/Timer.php';
} else {
    require_once $vendorDir . '/nikic/php-parser/lib/bootstrap.php';
    require_once $vendorDir . '/symfony/class-loader/Symfony/Component/ClassLoader/UniversalClassLoader.php';
    require_once $vendorDir . '/pear-pear.phpunit.de/PHP_Timer/PHP/Timer.php';
}

use Symfony\Component\ClassLoader\UniversalClassLoader;

$loader = new UniversalClassLoader();
$loader->registerNamespaces(array(
    'Symfony\\Component\\Finder'          => $vendorDir . '/symfony/finder',
    'Symfony\\Component\\EventDispatcher' => $vendorDir . '/symfony/event-dispatcher',
    'Symfony\\Component\\Console'         => $vendorDir . '/symfony/console',
    'Symfony\\Component\\ClassLoader'     => $vendorDir . '/symfony/class-loader',
    'Bartlett\\Tests\\Reflect'            => $baseDir . '/tests',
    'Bartlett'                            => $baseDir . '/src',
));
$loader->register();

if (PHP_SAPI !== 'cli') {
    return;
}

use Bartlett\Reflect\ConsoleApplication as Application;

$application = new Application();
$application->run();
