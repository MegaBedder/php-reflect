#!/usr/bin/env php
<?php
// CLI version 
//putenv("REFLECT=/path/to/reflect.json");

$phpParserDir = dirname(__DIR__) . DIRECTORY_SEPARATOR . 'vendor/PHP-Parser/lib';

require $phpParserDir . '/PhpParser/Autoloader.php';
PhpParser\Autoloader::register();

require_once 'Symfony/Component/ClassLoader/UniversalClassLoader.php';
require_once 'PHP/Timer.php';

use Symfony\Component\ClassLoader\UniversalClassLoader;

$loader = new UniversalClassLoader();
$loader->registerNamespaces(array(
    'Bartlett' => dirname(__DIR__) . DIRECTORY_SEPARATOR . 'src',
    'Symfony'  => dirname(__DIR__) . DIRECTORY_SEPARATOR . 'vendor',
));
$loader->register();

if (PHP_SAPI !== 'cli') {
    return;
}

use Bartlett\Reflect\Command\AnalyserListCommand;
use Bartlett\Reflect\Command\ProviderListCommand;
use Bartlett\Reflect\Command\ProviderShowCommand;
use Bartlett\Reflect\Command\ProviderDisplayCommand;
use Bartlett\Reflect\Command\PluginListCommand;
use Bartlett\Reflect\ConsoleApplication as Application;

$application = new Application();
$application->add(new AnalyserListCommand);
$application->add(new ProviderListCommand);
$application->add(new ProviderShowCommand);
$application->add(new ProviderDisplayCommand);
$application->add(new PluginListCommand);
$application->run();
